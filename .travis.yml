language: cpp

sudo: true

os: linux

compiler:
  - gcc

env:
  matrix:
    - SHELL_=
    - SHELL_=dash
    - SHELL_=zsh

before_install:
  # install desired shell and make it the shell of the user
  - if [ ! -z "$SHELL_" ]; then sudo apt-get install $SHELL_; export SHELL=/bin/$SHELL_; sudo chsh --shell=$SHELL $USER; fi
  # so that adjusted PATH propagates into sudo
  - sudo sed -i -e 's/^Defaults\tsecure_path.*$//' /etc/sudoers
  - sudo apt-get install flawfinder

install:
  - ./autogen.sh
  - ./configure --prefix=/usr/local
  - make
  - sudo make install
#  - sudo ldconfig

script:
  - make test
